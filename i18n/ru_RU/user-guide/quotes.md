# Предложения

Функция предложений доступна в [Advanced Pack](https://www.espocrm.com/extensions/advanced-pack/).

Предложения представляют собой определенную группу продуктов или услуг с их количеством и ценами, которые вы указываете клиентам.

Предложения связаны с сделками. Вы можете добавить «Предложения» в представление детализации «Сделки». Например вот так: Администрирование > Управление макетами > Сделки > Отношения. При создании нового предложения, связанного с сделкой, оно передает элементы сделки в предложение.

Вы можете добавить «Предложения» в представление детализации «Контрагентов», чтобы иметь возможность видеть связанные предложения. Это можно сделать: Администрирование > Управление макетами > Контрагенты > Отношения.

## Пункты предложений (Quote Item)

Предложение имеет список пунктов. Каждый пункт может представлять определенный продукт или услугу с указанием количества, налоговой ставки, цены и цены за единицу. Можно сортировать пункты вручную.

Существует возможность добавлять пользовательские поля для объекта Quote Item с помощью Управления объектами.

## Макет 

Расположение пунктов предложения можно изменить в разделе Администрирование > Управление макетами > Пункты предложения > Список (пункт). Доступно начиная с версии Advanced Pack 1.32.0.

## Скидка

Можно указать скидку в процентах. Чтобы иметь эту возможность, администратор должен добавить поле «Скидка (%)» (Discount (%)) в макет «Список (пункт)».

## Шаблоны

По умолчанию есть два доступных шаблона: Quote и Invoice. Вы можете создавать новые шаблоны (Представление списка для Предложений > Раскривающиеся меню справа вверху > Шаблоны), а также редактировать существующие.

Для более точного редактирования рекомендуется использовать режим просмотра кода.

Вы можете печатать поля записи предложений, а также поля связанных записей, используя заполнители в вашем шаблоне.

Примеры:
`{{accountName}}` – Имя контрагента,

`{{{billingAddressStreet}}}` – улица,

`{{account.type}}` – тип учетной записи,

`{{assignedUser.lastName}}` – последнее имя ответственного пользователя.

Если это продукт, вы можете печатать поля продукта.

Примеры:
`{{product.length}}`, 

`{{product.color}}`.

Длина и цвет - это пользовательские поля объекта Product в примерах.

Предложения по пунктам:

```
<!-- {{#each itemList}} -->
  <td>{{order}}</td>
  <td>{{name}}</td>
  <td>{{quantity}}</td>
  <td>{{product.weight}}</td>
  <td align="right">{{listPrice}}</td>
  <td align="right">{{unitPrice}}</td>
  <td align="right">{{amount}}</td>
<!-- {{/each}} -->
```

Можно напечатать поля изображения:

```
<img src="{{file imageId}}">
```
где `imageId` - имя поля настраиваемого изображения, объединенное с суффиксом `Id`.

Для продукта:
```
<img src="{{file product.photoId}}">
```

Для отображения чисел с плавающей точкой (количество, unitPrice и т. д.), без дробной части (как целое) используйте следующие выражения (начиная с версии 4.8.3):
```
{{numberFormat quantity_RAW decimals=0}}
```

Пользовательское форматирование значений валюты (начиная с версии 4.8.3):
```
{{numberFormat unitPrice_RAW decimals=2 decimalPoint=',' thousandsSeparator=' '}}
```
Значение `10000.5` нужно напечатать вот так: `10 000,50`.

Для отображения текстовых полей (многострочных) используйте тройные фигурные скобки: `{{{description}}}`.

## Печать в PDF

Предложения могут быть напечатаны в формате PDF. Это действие доступно в раскрывающемся меню рядом с кнопкой «Редактировать» в детализации предложения. Затем вам будет предложено выбрать «Шаблон».

## Отправка предложения по электронной почте

Предложение PDF можно отправить по электронной почте в виде вложения. Откройте запись предложение, щелкнуть выпадающий список рядом с кнопкой «Редактировать» и щелчком по электронной почте «PDF».

## Автоматическая нумерация

Вы можете создать поле Number через Управление объектами для типа объекта Предложение. Администрирование > Управление объектами > Предложение > Поля > Добавить > Номер. Затем вам нужно поместить его в подробное представление с помощью Управления макетами.

Значение будет увеличено на каждое новое предложение. Существует возможность указать следующий номер, а также префикс.

## Налог по умолчанию

Доступно с EspoCRM 4.8.0.

1. Укажите учетную запись по умолчанию в Администрировании > Управлении объектами > Предложения > поля > Налог > По умолчанию.
2. Укажите ставку налога по умолчанию в Администрировании > Управлении объектами > Предложения > поля > Налог (%) > По умолчанию.

## Счета

Предложение может рассматриваться как счет, если ее статус стал «Подтвержден». Появляются поля _Date Invoiced_, _Invoice Number_. Вы можете использовать другой шаблон счетов для печати.
