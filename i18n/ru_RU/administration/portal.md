# Портал

Портал предоставляет возможность доступа к конкретным данным и функциям crm для ваших клиентов и партнеров. Администратор может создавать несколько порталов. Каждый портал может иметь свои собственные настройки, панель виджетов, список пользователей, настройки контроля доступа.

Чтобы создать портал, перейдите в Администрирование > Порталы, нажмите кнопку «Создать портал».

* `Активный`. Если параметр не выбран, портал не будет доступен никому.
* `Портал по умолчанию`. Означает, что портал будет доступен по более короткому URL: http(s)://YOUR_ESPO_URL/portal.
* `Роли`. Укажите одну или несколько ролей портала, которые будут применяться к пользователям, зарегистрированным на портале. Более подробная информация о ролях портала приведена ниже.
* `Список вкладок`. Вкладки, которые будут отображаться на панели навигации.
* `Планировка панели виджетов`. Укажите виджеты, которые будут отображаться на главной странице портала. Обратите внимание, что пользователи портала не могут настроить свою панель.
* `URL`. Поле только для чтения, в котором отображается ссылка, с которой вы можете получить доступ к порталу.

## Пользователи портала

Администраторы могут создавать пользователей портала.

1. Администрирование > Пользователи.
2. Нажмите раскрывающуеся меню справа рядом с кнопкой «Создать пользователя».
3. Нажмите «Создать пользователя портала».
4. Выберите «Контакт», с которым будет связан пользователь портала.
5. Заполните форму и нажмите «Сохранить».

Пользователь портала должен быть связан с записью портала, чтобы иметь возможность доступа к этому порталу.

## Роли портала

Роли портала похожи на обычные роли в EspoCRM, но с несколькими отличиями.

* Уровень `не установлено` запрещает доступ.
* Уровень `владелец` означает, что запись создается пользователем. Например: пользователь портала редактирует какое-то обращение, и это обращение принадлежит этому пользователю.
* Уровень `контрагент` означает, что запись связана с контрагентом, с которым связан пользователь портала.
* Уровень `контакт` означает, что запись связана с контактом, с которым связан пользователь портала.

Поля «Ответственный» и «Группы» являются полями только для чтения для пользователей портала.

### Пример

`Пользователи портала должны иметь возможность создавать обращения, просматривать обращения, связанные с их учетной записью; они должны иметь возможность ознакомиться с базой знаний.`

1. Откройте форму «Создать роль портала» (Администрирование > Роли порталов > Создать роль портала).
2. Включите доступ к Обращениям, установите: `создать - да, чтение - контрагент, редактирование - нет, удаление - нет, лента - контрагент`.
3. Включите доступ к базе знаний, установите `создать - нет, чтение - контрагент, редактирование - нет, удаление - нет`.
4. Измените запись портала (Администрирование > Порталы). Выберите роль портала в поле «Роли», а затем сохраните.

## Доступ к порталу

URL-адрес портала можно найти в поле «URL» в записи портала. Также можно использовать инструменты настройки сервера (такие как mod_rewrite), чтобы иметь доступ к другому URL-адресу. Для этого случая вам нужно заполнить поле «Пользовательский URL».

### Доступ к порталу с помощью пользовательского URL для сервера Apache

Пользовательский URL: my-portal-host-name.com.

#### crm.portal.conf
```
<VirtualHost *:80>
	DocumentRoot /path/to/espocrm/instance/
	ServerName my-portal-host-name.com

    <Directory /path/to/espocrm/instance/>
        Options Indexes FollowSymLinks
        AllowOverride All
        Order allow,deny
        allow from all
    </Directory>

	ErrorLog ${APACHE_LOG_DIR}/error.log
	CustomLog ${APACHE_LOG_DIR}/access.log combined
</VirtualHost>

ServerAlias my-portal-host-name.com

```

#### Правила перезаписи Mod

Укажите идентификатор записи портала вместо `{PORTAL_ID}`. Идентификатор записи портала может быть доступен в адресной строке вашего веб-браузера при открытии подробной информации о записи портала. Например: https://my-espocrm-url.com/#Portal/16b9hm41c069e6j24. 16b9hm41c069e6j24 - это идентификатор записи портала.

```
  RewriteCond %{HTTP_HOST} ^portal-host-name.com$
  RewriteRule ^client - [L]

  RewriteCond %{HTTP_HOST} ^portal-host-name.com$
  RewriteCond %{REQUEST_URI} !^/portal/{PORTAL_ID}/.*$
  RewriteRule ^(.*)$ /portal/{PORTAL_ID}/$1 [L]
```
